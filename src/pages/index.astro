---
import Layout from "../layouts/Layout.astro";
---

<Layout title="Social Media Content Generator">
  <main class="max-w-4xl mx-auto py-10 px-4">
    <h1 class="text-3xl font-bold text-center mb-8">Social Media Content Generator</h1>

    <div class="bg-white p-6 rounded-lg shadow-md">
      <!-- Step 1: Transcript Input -->
      <div id="step-transcript" class="mb-6">
        <div class="flex items-center mb-2">
          <label for="shared-transcript" class="text-sm font-medium text-gray-700"
            >Schritt 1: Transkript eingeben</label
          >
        </div>
        <textarea
          id="shared-transcript"
          rows="10"
          class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"
          placeholder="Füge dein Transkript hier ein..."></textarea>
        <div class="mt-4">
          <button
            type="button"
            id="detect-keywords-btn"
            class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            disabled
          >
            Keywords automatisch erkennen
          </button>
        </div>
      </div>

      <!-- Step 2: Keywords Section (initially hidden) -->
      <div id="step-keywords" class="mb-6 hidden">
        <div class="flex items-center mb-2">
          <label class="text-sm font-medium text-gray-700">Schritt 2: Keywords bearbeiten</label>
        </div>

        <!-- Keywords Container -->
        <div
          id="keywords-container"
          class="min-h-[3rem] p-3 border border-gray-300 rounded-md focus-within:ring-1 focus-within:ring-indigo-500 focus-within:border-indigo-500 mb-4"
        >
          <div id="keywords-list" class="flex flex-wrap gap-2 mb-2"></div>
          <input
            type="text"
            id="keyword-input"
            placeholder="Keyword hinzufügen und Enter drücken..."
            class="w-full border-0 outline-none text-sm placeholder-gray-400 focus:ring-0"
            disabled
          />
        </div>
        <div class="text-xs text-gray-500 mb-4">
          <span id="keyword-count">0</span>/3 Keywords
        </div>
        <div class="flex space-x-3">
          <button
            type="button"
            id="clear-keywords-btn"
            class="flex-1 py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
          >
            Keywords löschen
          </button>
          <button
            type="button"
            id="set-keywords-btn"
            class="flex-1 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"
            disabled
          >
            Keywords bestätigen
          </button>
        </div>
      </div>

      <!-- Step 3: Social Media Tabs (initially hidden) -->
      <div id="step-social" class="hidden">
        <div class="flex items-center mb-4">
          <label class="text-sm font-medium text-gray-700"
            >Schritt 3: Social Media Content generieren</label
          >
        </div>

        <!-- Tabs -->
        <div class="flex border-b border-gray-200 mb-6">
          <button
            id="youtube-tab"
            class="px-6 py-2 font-medium border-b-2 border-red-600 text-red-600 rounded-t-md"
            >YouTube</button
          >
          <button
            id="linkedin-tab"
            class="px-6 py-2 font-medium text-gray-500 hover:text-blue-600 rounded-t-md"
            >LinkedIn</button
          >
          <button
            id="twitter-tab"
            class="px-6 py-2 font-medium text-gray-500 hover:text-black rounded-t-md"
            >Twitter</button
          >
          <button
            id="instagram-tab"
            class="px-6 py-2 font-medium text-gray-500 hover:text-pink-600 rounded-t-md"
            >Instagram</button
          >
          <button
            id="tiktok-tab"
            class="px-6 py-2 font-medium text-gray-500 hover:text-black rounded-t-md">TikTok</button
          >
        </div>

        <!-- YouTube Form -->
        <div id="youtube-content" class="block">
          <form id="yt-form" class="space-y-6">
            <div class="hidden">
              <textarea id="yt-transcript" name="transcript" class="hidden"></textarea>
            </div>

            <!-- Optional Video Duration Input -->
            <div>
              <label for="video-duration" class="block text-sm font-medium text-gray-700 mb-2">
                Video-Dauer (optional)
              </label>
              <input
                type="text"
                id="video-duration"
                name="videoDuration"
                placeholder="z.B. 7:16"
                pattern="^([0-9]{1,2}):([0-5][0-9])$"
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500"
                title="Format: MM:SS (z.B. 7:16)"
              />
              <p class="mt-1 text-xs text-gray-500">
                Bei Eingabe der Video-Dauer werden automatisch Zeitstempel mit Topics generiert
              </p>
            </div>

            <button
              type="submit"
              id="youtube-generate-btn"
              class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
            >
              YouTube Content generieren
            </button>
          </form>

          <!-- Copy buttons for YouTube -->
          <div id="yt-copy-buttons" class="hidden mt-3 flex justify-center space-x-2">
            <button
              id="copy-transcript-btn"
              class="py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
            >
              Transkript kopieren
            </button>
            <button
              id="copy-title-btn"
              class="py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
            >
              Titel kopieren
            </button>
            <button
              id="copy-description-btn"
              class="py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
            >
              Beschreibung kopieren
            </button>
            <button
              id="copy-timestamps-btn"
              class="py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 hidden"
            >
              Zeitstempel kopieren
            </button>
          </div>
        </div>

        <!-- LinkedIn Form -->
        <div id="linkedin-content" class="hidden">
          <form id="li-form" class="space-y-6">
            <div class="hidden">
              <textarea id="li-transcript" name="transcript" class="hidden"></textarea>
            </div>

            <button
              type="submit"
              id="linkedin-generate-btn"
              class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
            >
              LinkedIn Post generieren
            </button>
          </form>

          <!-- Copy button for LinkedIn -->
          <div id="li-copy-buttons" class="hidden mt-3 flex justify-center">
            <button
              id="copy-linkedin-btn"
              class="py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
            >
              LinkedIn Post kopieren
            </button>
          </div>
        </div>

        <!-- Twitter Form -->
        <div id="twitter-content" class="hidden">
          <form id="tw-form" class="space-y-6">
            <div class="hidden">
              <textarea id="tw-transcript" name="transcript" class="hidden"></textarea>
            </div>

            <button
              type="submit"
              id="twitter-generate-btn"
              class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-black hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"
            >
              Twitter Post generieren
            </button>
          </form>

          <!-- Copy button for Twitter -->
          <div id="tw-copy-buttons" class="hidden mt-3 flex justify-center">
            <button
              id="copy-twitter-btn"
              class="py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black"
            >
              Twitter Post kopieren
            </button>
          </div>
        </div>

        <!-- Instagram Form -->
        <div id="instagram-content" class="hidden">
          <form id="ig-form" class="space-y-6">
            <div class="hidden">
              <textarea id="ig-transcript" name="transcript" class="hidden"></textarea>
            </div>

            <button
              type="submit"
              id="instagram-generate-btn"
              class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500"
            >
              Instagram Post generieren
            </button>
          </form>

          <!-- Copy button for Instagram -->
          <div id="ig-copy-buttons" class="hidden mt-3 flex justify-center">
            <button
              id="copy-instagram-btn"
              class="py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500"
            >
              Instagram Post kopieren
            </button>
          </div>
        </div>

        <!-- TikTok Form -->
        <div id="tiktok-content" class="hidden">
          <form id="tt-form" class="space-y-6">
            <div class="hidden">
              <textarea id="tt-transcript" name="transcript" class="hidden"></textarea>
            </div>

            <button
              type="submit"
              id="tiktok-generate-btn"
              class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-black hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"
            >
              TikTok Post generieren
            </button>
          </form>

          <!-- Copy button for TikTok -->
          <div id="tt-copy-buttons" class="hidden mt-3 flex justify-center">
            <button
              id="copy-tiktok-btn"
              class="py-1 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black"
            >
              TikTok Post kopieren
            </button>
          </div>
        </div>
      </div>

      <!-- Loading Spinner -->
      <div id="loading" class="hidden mt-6 text-center">
        <div
          id="youtube-spinner"
          class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-red-600"
        >
        </div>
        <div
          id="linkedin-spinner"
          class="hidden inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-600"
        >
        </div>
        <div
          id="twitter-spinner"
          class="hidden inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-black"
        >
        </div>
        <div
          id="instagram-spinner"
          class="hidden inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-pink-500"
        >
        </div>
        <div
          id="tiktok-spinner"
          class="hidden inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-black"
        >
        </div>
        <p class="mt-2 text-gray-600">Transkript wird analysiert und Content generiert...</p>
      </div>

      <!-- YouTube Results -->
      <div id="yt-result" class="hidden mt-6 space-y-6">
        <div>
          <h2 class="text-lg font-medium text-gray-900 mb-2">Korrigiertes Transkript</h2>
          <div
            id="transcript-content"
            class="p-4 bg-gray-50 rounded-md border border-gray-200 max-h-[300px] overflow-y-auto"
          >
          </div>
          <div id="transcript-cleaned" class="mt-1 text-xs text-amber-600 hidden">
            Hinweis: Ein einzelnes Zeichen am Ende des Transkripts wurde automatisch entfernt.
          </div>
          <div id="model-used" class="mt-1 text-xs text-indigo-600">
            Modell: <span id="model-name"></span>
          </div>
        </div>

        <div>
          <h2 class="text-lg font-medium text-gray-900 mb-2">YouTube Titel</h2>
          <div id="title-content" class="p-4 bg-gray-50 rounded-md border border-gray-200"></div>
        </div>

        <div>
          <h2 class="text-lg font-medium text-gray-900 mb-2">YouTube Beschreibung</h2>
          <div
            id="description-content"
            class="p-4 bg-gray-50 rounded-md border border-gray-200 whitespace-pre-line"
          >
          </div>
        </div>

        <!-- Timestamps Section (only shown when generated) -->
        <div id="timestamps-section" class="hidden">
          <h2 class="text-lg font-medium text-gray-900 mb-2">Zeitstempel</h2>
          <div
            id="timestamps-content"
            class="p-4 bg-gray-50 rounded-md border border-gray-200 whitespace-pre-line"
          >
          </div>
        </div>
      </div>

      <!-- LinkedIn Results -->
      <div id="li-result" class="hidden mt-6 space-y-6">
        <div>
          <h2 class="text-lg font-medium text-gray-900 mb-2">LinkedIn Post</h2>
          <div
            id="linkedin-content-result"
            class="p-4 bg-gray-50 rounded-md border border-gray-200 whitespace-pre-line"
          >
          </div>
          <div id="li-model-used" class="mt-1 text-xs text-indigo-600">
            Modell: <span id="li-model-name"></span>
          </div>
        </div>
      </div>

      <!-- Twitter Results -->
      <div id="tw-result" class="hidden mt-6 space-y-6">
        <div>
          <h2 class="text-lg font-medium text-gray-900 mb-2">Twitter Post</h2>
          <div
            id="twitter-content-result"
            class="p-4 bg-gray-50 rounded-md border border-gray-200 whitespace-pre-line"
          >
          </div>
          <div id="tw-model-used" class="mt-1 text-xs text-indigo-600">
            Modell: <span id="tw-model-name"></span>
          </div>
        </div>
      </div>

      <!-- Instagram Results -->
      <div id="ig-result" class="hidden mt-6 space-y-6">
        <div>
          <h2 class="text-lg font-medium text-gray-900 mb-2">Instagram Post</h2>
          <div
            id="instagram-content-result"
            class="p-4 bg-gray-50 rounded-md border border-gray-200 whitespace-pre-line"
          >
          </div>
          <div id="ig-model-used" class="mt-1 text-xs text-indigo-600">
            Modell: <span id="ig-model-name"></span>
          </div>
        </div>
      </div>

      <!-- TikTok Results -->
      <div id="tt-result" class="hidden mt-6 space-y-6">
        <div>
          <h2 class="text-lg font-medium text-gray-900 mb-2">TikTok Post</h2>
          <div
            id="tiktok-content-result"
            class="p-4 bg-gray-50 rounded-md border border-gray-200 whitespace-pre-line"
          >
          </div>
          <div id="tt-model-used" class="mt-1 text-xs text-indigo-600">
            Modell: <span id="tt-model-name"></span>
          </div>
        </div>
      </div>

      <!-- Error Message -->
      <div
        id="error"
        class="hidden mt-6 p-4 bg-red-50 text-red-700 rounded-md border border-red-200"
      >
        <p id="error-message"></p>
      </div>
    </div>
  </main>
</Layout>

<script type="module" src="/src/scripts/main.js"></script>
